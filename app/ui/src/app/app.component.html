<div class="modal fade" id="inputHelpModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Input Help</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <ol>
            <li class="mb-2">
                Enter your inputs and click the 'Compute' button to run the analysis.
            </li>
            <li class="mb-2">
                The 'Compute' button becomes clickable only if all the inputs are valid.
            </li>
            <li class="mb-2">
                For "1. Grid size (upper-right coordinates)", fields "X" and "Y" can accept a value between and including 1 and 50.
            </li>
            <li class="mb-2">
                For "2. Robots Configuration:"
                <ol>
                    <li class="mb-1">
                        All the four fields - "X", "Y", "Direction" & "Instructions", in the "Robot Position" and "Instructions" columns are required.
                    </li>
                    <li class="mb-1">
                        You can have any number of robots added to the simulation by clicking "Add Robot" button.
                    </li>
                    <li class="mb-1">
                        The 'Compute' button becomes clickable only if the values for all the four input fields for every robot is present.
                    </li>
                </ol>
            </li>
        </ol>
      </div>
    </div>
  </div>
</div>

<header class="text-center my-4">
        <h1 class="display-4">Tool to analyse how robots move on Mars.</h1>
</header>

<hr/>

<main class="px-5">

  <form [formGroup]="robotsConfigurationForm" (ngSubmit)="onCompute($event)">
      <div class="row">
          <div class="col-8 col-xl-7 border-end">
              
            <div class="d-flex mb-4" style="justify-content: space-between; align-items: center;">

                <h5 class="h5">Please enter your inputs below</h5>

                <div class="d-flex">
                    <button type="button" class="btn btn-sm btn-link"  data-bs-toggle="modal" data-bs-target="#inputHelpModal">Help</button>
                    <button type="button" class="btn btn-sm btn-link" [disabled]="robotsConfigurationForm.disabled" (click)="loadDefaultValues()">Load default values</button>
                </div>
            </div>
              

              <!-- <div class="d-flex mb-4" style="justify-content: center;">
                <div class="card" style="width: 60%;">
                    <div class="card-body">
                        <h5 class="card-title">Instructions:</h5>
                        
                        <div class="card-text">
                            <ol>
                                <li>
                                    All the input fields require values.
                                </li>
                                <li>
                                    "Compute" button becomes clickable once all the input fields are entered and valid
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
              </div> -->
            
              <div class="row mt-5 mb-4">
                  <div class="col-7 col-xl-5">
                      <p class="lead">
                          1. Grid size (upper-right coordinates):
                      </p>
                  </div>
                  <div class="col-2">
                      <input formControlName="gridSizeX" type="number" class="form-control" placeholder="X">
                  </div>
                  <div class="col-2">
                      <input formControlName="gridSizeY" type="number" class="form-control" placeholder="Y">
                  </div>
              </div>

              <!-- <hr/> -->

              <div>
                  <div class="d-flex mb-3" style="justify-content: space-between;">

                      <p class="lead">
                          2. Robots Configuration:
                      </p>

                      <button [disabled]="robotsConfigurationForm.disabled" type="button" class="btn btn-primary btn-sm" (click)="addRobot()">Add Robot</button>

                  </div>

                  <div class="px-3" style="max-height: 48vh; overflow-y: auto;">

                      <table class="table table-stripped table-bordered">
                          <thead class="table-light" style="position: sticky; top: 0; z-index: 2;">
                              <tr>
                                  <th scope="col" style="text-align: center; width: 16%" >
                                      #
                                  </th>
                                  <th scope="col" style="text-align: center; width: 35%">
                                      Robot Position
                                  </th>
                                  <th scope="col" style="text-align: center; width: 35%">
                                      Instructions
                                  </th>
                                  <th scope="col" style="text-align: center; width: 13%">
                                      Actions
                                  </th>
                              </tr>
                          </thead>
                          <tbody>
                            @for (robotConfig of robotsConfigurationForm.controls.robotConfiguration.controls; track robotConfig; let inn = $index) {

                                <tr [formGroup]="robotConfig">
                                  <td style="white-space: nowrap; align-items: center; vertical-align: middle;">
                                      Robot {{inn + 1}}
                                  </td>
                                  <td class="d-flex" style="padding-top: 12px; padding-bottom: 12px; justify-content: center;">
                                      <input [formControl]="robotConfig.controls.robotPositionX" type="number" style="width: 23%" class="form-control form-control-sm me-2" placeholder="X">

                                      <input [formControl]="robotConfig.controls.robotPositionY" type="number" style="width: 23%" class="form-control form-control-sm me-2" placeholder="Y" >

                                      <input [formControl]="robotConfig.controls.robotOrientation" type="text" style="width: 40%" class="form-control form-control-sm" placeholder="Direction" >
                                  </td>
                                  <td style="padding-top: 12px; padding-bottom: 12px;">
                                      <input [formControl]="robotConfig.controls.robotInstructions" type="text" style="width: 87%;" class="form-control form-control-sm" placeholder="Instructions">
                                  </td>
                                  <td class="d-flex" style="justify-content: center;">
                                    <button type="button" style="z-index: 1;" class="btn btn-sm btn-outline-danger" [disabled]="robotsConfigurationForm.disabled" (click)="removeRobot(inn)">&times;</button>
                                  </td>
                              </tr>
                            }
                              
                          </tbody>
                          
                      </table>
                  </div>
              </div>

              <div  class="mt-4 d-flex" style="justify-content: center;">
                  <button class="btn btn-success me-2" type="submit" [disabled]="!robotsConfigurationForm.valid || robotsConfigurationForm.disabled">
                      Compute
                  </button>
                  <button class="btn btn-warning" type="button" [disabled]="robotsConfigurationForm.disabled" (click)="clearFields()">
                      Clear fields
                  </button>
              </div>
          </div>
          <div class="col-4 col-xl-5 ps-3">
              <h3 class="h5 mb-3">Outputs</h3>
              @if (resultOutput && resultOutput.length) {
                <ul class="list-group list-group-flush mb-5">
                    @for (resultLine of resultOutput; track resultLine) {
                        <li class="list-group-item">{{resultLine}}</li>
                    }
                </ul>

                <button type="button" class="btn btn-warning" (click)="reset()">Reset</button>
              }
          </div>
      </div>
  </form>
</main>

<router-outlet />
